<?php

header('Content-type: application/json');

require dirname(__FILE__) . '/../classes/headstart/persistence/SQLitePersistence.php';
require_once dirname(__FILE__) . '/../classes/headstart/library/CommUtils.php';
require_once dirname(__FILE__) . '/../classes/headstart/library/toolkit.php';

use headstart\library;

$INI_DIR = dirname(__FILE__) . "/../preprocessing/conf/";

$ini_array = library\Toolkit::loadIni($INI_DIR);

$vis_id = library\CommUtils::getParameter($_GET, "vis_id");

$persistence = new headstart\persistence\SQLitePersistence($ini_array["connection"]["sqlite_db"]);

$jsonData = $persistence->getLastVersion($vis_id);

library\CommUtils::echoOrCallback($jsonData, $_GET);
